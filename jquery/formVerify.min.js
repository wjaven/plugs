$.extend($.fn,{formVerify:function(){var f=$(this);var b={};var k,l=[],g,n=[];k=$(f).find("[gvalid]");for(var e=0,h=k.length;e<h;e++){var o=$(k).eq(e).attr("gvalid").split(";");l.push({node:$(k).eq(e),required:o[0],type:o[1],range:o[2],txt:o[3].substring(1,o[3].length-1)})}g=$(f).find("[grepeat]");for(var e=0,h=g.length;e<h;e++){var o=$(g).eq(e).attr("grepeat").split(";");n.push({node:$(g).eq(e),to:o[0],txt:o[1].substring(1,o[1].length-1)})}b.bindform=function(){$.each(l,function(p,q){$(q.node).on("focusout",function(){j($(this),$(this).val(),q.required,q.type,q.range,q.txt)})});$.each(n,function(p,q){$(q.node).on("focusout",function(){c($(q.node),$(q.node).val(),$(f).find("["+q.to+"]").val(),q.txt)})})};b.subform=function(){$.each(l,function(s,t){if($(t.node).prev().attr("gvalid")&&$(t.node).closest("dd").next(".hint").css("display")=="block"){return}j($(t.node),$(t.node).val(),t.required,t.type,t.range,t.txt)});$.each(n,function(s,t){c($(t.node),$(t.node).val(),$(f).find("["+t.to+"]").val(),t.txt)});var r=$(f).find(".hint");for(var q=0,p=r.length;q<p;q++){if($(r).eq(q).closest("dl").css("display")=="none"){continue}if($(r).eq(q).css("display")=="block"){return true}}return false};if(String.prototype.trim==undefined){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}function j(r,s,t,q,p,i){if(!s||!s.trim()){if(t=="true"){$(r).closest("dd").next(".hint").find("span").text("必填项:"+i);$(r).closest("dd").next(".hint").show()}else{$(r).closest("dd").next(".hint").hide()}}else{if(!a(s,q,p)){$(r).closest("dd").next(".hint").find("span").text("格式有误:"+i);$(r).closest("dd").next(".hint").show()}else{$(r).closest("dd").next(".hint").hide()}}}function c(q,r,p,i){if(r==p){$(q).closest("dd").next(".hint").hide()}else{$(q).closest("dd").next(".hint").find("span").text(i);$(q).closest("dd").next(".hint").show()}}function a(r,q,p){var i;switch(q){case"letter":i=r.match("^[a-zA-Z0-9_]"+p+"$");break;case"number":i=r.match("^[0-9]"+p+"$");break;case"mobile":i=r.match("^((1[3,5,8][0-9])|(14[5,7])|(17[0,1,6,7,8]))[0-9]{8}$");break;case"phone":i=r.match("^(0[0-9]{2,3}|(0[0-9]{2,3}-))?[0-9]{7,8}$");break;case"contact":i=r.match("^(0[0-9]{2,3}|(0[0-9]{2,3}-))?[0-9]{7,8}$")||r.match("^((1[3,5,8][0-9])|(14[5,7])|(17[0,1,6,7,8]))[0-9]{8}$");break;case"email":i=r.match("^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$");break;case"IDcard":i=r.match("^(^[0-9]{15}$|^[0-9]{18}$|^[0-9]{17}([0-9]|X|x))$");break;case"CN":i=r.match("^[\u4e00-\u9fa5]"+p+"$");break;case"int":i=m(r,p);break;case"len":i=d(r,p);break;case"postcode":i=r.match("^[1-9][0-9]{5}$");break;default:i=true;break}return i}function m(q,p){if(q!=parseInt(q)){return false}var i=p.substring(1,p.length-1).split(",");console.log();return i[1]==""?(q>=parseInt(i[0])):(q>=parseInt(i[0])&&q<=parseInt(i[1]))}function d(r,q){var p=r.length;if(q.indexOf(",")<0){return p==q.substring(1,q.length-1)}else{var i=q.substring(1,q.length-1).split(",");return i[1]==""?(p>=i[0]):(p>=i[0]&&p<=i[1])}}return b}});
